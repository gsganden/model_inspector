---

title: inspect


keywords: fastai
sidebar: home_sidebar

summary: "Inspect models."
description: "Inspect models."
nb_path: "00_inspect.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 00_inspect.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_inspector" class="doc_header"><code>get_inspector</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L157" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_inspector</code>(<strong><code>model</code></strong>, <strong><code>X</code></strong>, <strong><code>y</code></strong>)</p>
</blockquote>
<p>Get an appropriate inspector for your model and data</p>
<p>Parameters:</p>
<ul>
<li><code>model</code>: Fitted sklearn model</li>
<li><code>X</code>: Feature matrix with same shape and column meanings as
features <code>model</code> was trained on</li>
<li><code>y</code>: Target series with same length as <code>X</code> and same meaning as
target <code>model</code> was trained on</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">_Multi2dMultiPlotter</span><span class="p">(</span><span class="n">_Multi2dPlotter</span><span class="p">,</span> <span class="n">_2dMultiPlotterMixin</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Methods whose names begin with "plot" generate matplotlib plots and return the relevant <code>Axes</code> object or NumPy array of <code>Axes</code> objects.</p>
<p>Methods whose names begin with "show" generate visuals in a different way; currently they all rely on Jupyter-like HTML rendering.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="kn">import</span> <span class="nn">sklearn.datasets</span>
<span class="kn">from</span> <span class="nn">model_inspector.tune</span> <span class="kn">import</span> <span class="n">calculate_metric_ignoring_nan</span><span class="p">,</span> <span class="n">coverage</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span><span class="p">,</span> <span class="n">DecisionTreeRegressor</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="All-Models">All Models<a class="anchor-link" href="#All-Models"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Every <code>Inspector</code> object has these methods.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="show_correlation" class="doc_header"><code>show_correlation</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L148" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>show_correlation</code>(<strong><code>method</code></strong>=<em><code>'pearson'</code></em>, <strong><code>cmap</code></strong>=<em><code>'PuBu'</code></em>, <strong><code>low</code></strong>:<code>float</code>=<em><code>0</code></em>, <strong><code>high</code></strong>:<code>float</code>=<em><code>0</code></em>, <strong><code>axis</code></strong>:<code>Union</code>[<code>str</code>, <code>int</code>, <code>NoneType</code>]=<em><code>0</code></em>, <strong><code>subset</code></strong>=<em><code>None</code></em>, <strong><code>text_color_threshold</code></strong>:<code>float</code>=<em><code>0.408</code></em>, <strong><code>vmin</code></strong>:<code>Optional</code>[<code>float</code>]=<em><code>None</code></em>, <strong><code>vmax</code></strong>:<code>Optional</code>[<code>float</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Show a correlation matrix for <code>self.X</code> and <code>self.y</code>
Remaining parameters are passed to
<code>model_inspector.explore.show_correlation</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_diabetes</span><span class="p">,</span> <span class="n">y_diabetes</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_diabetes</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">RandomForestRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_diabetes</span><span class="p">,</span> <span class="n">y_diabetes</span><span class="p">),</span> <span class="n">X_diabetes</span><span class="p">,</span> <span class="n">y_diabetes</span>
<span class="p">)</span>

<span class="n">inspector</span><span class="o">.</span><span class="n">show_correlation</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="permutation_importance" class="doc_header"><code>permutation_importance</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L101" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>permutation_importance</code>(<strong><code>sort</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>scoring</code></strong>=<em><code>None</code></em>, <strong><code>n_repeats</code></strong>=<em><code>5</code></em>, <strong><code>n_jobs</code></strong>=<em><code>None</code></em>, <strong><code>random_state</code></strong>=<em><code>None</code></em>, <strong><code>sample_weight</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Calculate permutation importance</p>

<pre><code>    - `sort`: Sort features by decreasing importance

</code></pre>
<p>Remaining parameters are passed to
<code>sklearn.inspection._permutation_importance.permutation_importance</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span><span class="o">.</span><span class="n">permutation_importance</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="plot_permutation_importance" class="doc_header"><code>plot_permutation_importance</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L122" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>plot_permutation_importance</code>(<strong><code>ax</code></strong>:<code>Optional</code>[<code>Axes</code>]=<em><code>None</code></em>, <strong><code>importance_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>plot_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot a correlation matrix for <code>self.X</code> and <code>self.y</code></p>
<p>Parameters:</p>
<ul>
<li><code>ax</code>: Matplotlib <code>Axes</code> object. Plot will be added to this object
if provided; otherwise a new <code>Axes</code> object will be generated.</li>
<li><code>importance_kwargs</code>: kwargs to pass to
<code>sklearn.inspection.permutation_importance</code></li>
<li><code>plot_kwargs</code>: kwargs to pass to <code>pd.Series.plot.barh</code></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_permutation_importance</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_fig_exists</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regressors">Regressors<a class="anchor-link" href="#Regressors"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All regression model <code>Inspectors</code> have the following methods.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="plot_pred_vs_act" class="doc_header"><code>plot_pred_vs_act</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L313" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>plot_pred_vs_act</code>(<strong><code>ax</code></strong>:<code>Optional</code>[<code>Axes</code>]=<em><code>None</code></em>, <strong><code>scatter_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>line_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot predicted vs. actual values</p>
<p>Parameters:</p>
<ul>
<li><code>ax</code>: Matplotlib <code>Axes</code> object. Plot will be added to this object
if provided; otherwise a new <code>Axes</code> object will be generated.</li>
<li><code>scatter_kwargs</code>: kwargs to pass to <code>plt.scatter</code></li>
<li><code>line_kwargs</code>: kwargs to pass to <code>plt.plot</code></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_pred_vs_act</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="plot_residuals" class="doc_header"><code>plot_residuals</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L354" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>plot_residuals</code>(<strong><code>axes</code></strong>:<code>Optional</code>[<code>array</code>]=<em><code>None</code></em>, <strong><code>scatter_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>line_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>hist_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot residuals</p>
<p>Parameters:</p>
<ul>
<li><code>axes</code>: 1D array of two Matplotlib <code>Axes</code> objects. Plot will
be added to these objects if provided; otherwise a new array of
<code>Axes</code> objects will be generated.</li>
<li><code>scatter_kwargs</code>: kwargs to pass to <code>plt.scatter</code></li>
<li><code>line_kwargs</code>: kwargs to pass to <code>plt.plot</code> for line at y=0</li>
<li><code>hist_kwargs</code>: kwargs to pass to <code>plt.hist</code> for histogram of
residuals</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">)</span>

<span class="n">axes</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">)</span><span class="o">.</span><span class="n">plot_residuals</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Classifiers">Classifiers<a class="anchor-link" href="#Classifiers"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Every <code>Inspector</code> object for a classification model has these methods, but the details of the implementation may depend on whether the classifier is binary or multiclass.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="calculate_metrics_by_thresh (binary)" class="doc_header"><code>calculate_metrics_by_thresh (binary)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L215" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>calculate_metrics_by_thresh (binary)</code>(<strong><code>metrics</code></strong>:<code>Union</code>[<code>Callable</code>, <code>Sequence</code>[<code>Callable</code>]])</p>
</blockquote>
<p>Calculate classification metrics as a function of threshold</p>
<p>Assumes that <code>self.model</code> has a <code>.predict_proba()</code> method. Uses
<code>self.y</code> as ground-truth values,
<code>self.model.predict_proba(self.X)[:, 1] &gt; thresh</code> as
predictions.</p>
<p>Parameters:</p>
<ul>
<li><code>metrics</code>: Callables that take <code>y_true</code>, <code>y_pred</code> as
positional arguments and return a number. Must have a <code>__name__</code>
attribute.</li>
</ul>
<p>Returns: DataFrame with one column "thresh" indicating the
thresholds used, which is 0 and the sorted set of values that
occur in <code>y_prob</code>, and an additional column for each input
metric giving the value of that metric at that threshold.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_cancer_train</span><span class="p">,</span> <span class="n">X_cancer_test</span><span class="p">,</span> <span class="n">y_cancer_train</span><span class="p">,</span> <span class="n">y_cancer_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span>
<span class="p">)</span>
<span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">RandomForestClassifier</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer_train</span><span class="p">,</span> <span class="n">y_cancer_train</span><span class="p">),</span>
    <span class="n">X_cancer_test</span><span class="p">,</span>
    <span class="n">y_cancer_test</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">metrics_by_thresh</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">calculate_metrics_by_thresh</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">metrics_by_thresh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">metrics_by_thresh</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;thresh&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="confusion_matrix (binary)" class="doc_header"><code>confusion_matrix (binary)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L242" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>confusion_matrix (binary)</code>(<strong><code>thresh</code></strong>:<code>float</code>=<em><code>0.5</code></em>, <strong><code>labels</code></strong>=<em><code>None</code></em>, <strong><code>sample_weight</code></strong>=<em><code>None</code></em>, <strong><code>normalize</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get confusion matrix</p>

<pre><code>    Assumes that `self.model` has a `.predict_proba()` method. Uses
    `self.y` as ground-truth values,
    `self.model.predict_proba(self.X)[:, 1] &gt; thresh` as
    predictions.

    Parameters:
    - `thresh`: Probability threshold for counting a prediction as
    positive

</code></pre>
<p>Remaining parameters are passed to
<code>sklearn.metrics._classification.confusion_matrix</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span>
    <span class="n">thresh</span><span class="o">=</span><span class="n">metrics_by_thresh</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">metrics_by_thresh</span><span class="o">.</span><span class="n">f1_score</span><span class="o">.</span><span class="n">idxmax</span><span class="p">(),</span> <span class="s2">&quot;thresh&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="calculate_metrics_by_thresh (multiclass)" class="doc_header"><code>calculate_metrics_by_thresh (multiclass)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L267" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>calculate_metrics_by_thresh (multiclass)</code>(<strong><code>metrics</code></strong>:<code>Union</code>[<code>Callable</code>, <code>Sequence</code>[<code>Callable</code>]])</p>
</blockquote>
<p>Calculate classification metrics as a function of threshold</p>
<p>Assumes that <code>self.model</code> has a <code>.predict_proba()</code> method. Uses
<code>self.y</code> as ground-truth values, uses the value with the highest
probability as the prediction if that probability exceeds the
threshold, <code>np.nan</code> otherwise.</p>
<p>Parameters:</p>
<ul>
<li><code>metrics</code>: Callables that take <code>y_true</code>, <code>y_pred</code> as
positional arguments and return a number. Must have a <code>__name__</code>
attribute and must be able to handle <code>np.nan</code> values.</li>
</ul>
<p>Returns: DataFrame with one column "thresh" indicating the
thresholds used, which is 0 and the sorted set of values that
occur in <code>y_prob</code>, and an additional column for each input
metric giving the value of that metric at that threshold.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">precision_ignoring_nan</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
    <span class="n">calculate_metric_ignoring_nan</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;micro&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">precision_ignoring_nan</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="s2">&quot;precision_ignoring_nan&quot;</span>

<span class="n">X_iris</span><span class="p">,</span> <span class="n">y_iris</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">as_frame</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_iris_train</span><span class="p">,</span> <span class="n">X_iris_test</span><span class="p">,</span> <span class="n">y_iris_train</span><span class="p">,</span> <span class="n">y_iris_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_iris</span><span class="p">,</span> <span class="n">y_iris</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
<span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">RandomForestClassifier</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_iris_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="n">y_iris_train</span><span class="p">),</span>
    <span class="n">X_iris_test</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]],</span>
    <span class="n">y_iris_test</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">metrics_by_thresh</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">calculate_metrics_by_thresh</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">coverage</span><span class="p">,</span> <span class="n">precision_ignoring_nan</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">metrics_by_thresh</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">metrics_by_thresh</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;thresh&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="confusion_matrix (multiclass)" class="doc_header"><code>confusion_matrix (multiclass)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L294" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>confusion_matrix (multiclass)</code>(<strong><code>cmap</code></strong>=<em><code>'PuBu'</code></em>, <strong><code>low</code></strong>:<code>float</code>=<em><code>0</code></em>, <strong><code>high</code></strong>:<code>float</code>=<em><code>0</code></em>, <strong><code>axis</code></strong>:<code>Union</code>[<code>str</code>, <code>int</code>, <code>NoneType</code>]=<em><code>0</code></em>, <strong><code>subset</code></strong>=<em><code>None</code></em>, <strong><code>text_color_threshold</code></strong>:<code>float</code>=<em><code>0.408</code></em>, <strong><code>vmin</code></strong>:<code>Optional</code>[<code>float</code>]=<em><code>None</code></em>, <strong><code>vmax</code></strong>:<code>Optional</code>[<code>float</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Get confusion matrix</p>

<pre><code>    Uses `self.y` as ground-truth values,
    `self.model.predict(self.X)` as predictions.

</code></pre>
<p>Remaining parameters are passed to
<code>pandas.io.formats.style.background_gradient</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Models">Linear Models<a class="anchor-link" href="#Linear-Models"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inspectors for models that inherit from <code>LinearModel</code> or <code>LinearClassifierMixin</code> (and thus have an intercept and coefficients) have the following methods.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="show_model (linear model)" class="doc_header"><code>show_model (linear model)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L534" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>show_model (linear model)</code>(<strong><code>intercept_formatter</code></strong>:<code>str</code>=<em><code>'.2f'</code></em>, <strong><code>coef_formatter</code></strong>:<code>str</code>=<em><code>'.2f'</code></em>)</p>
</blockquote>
<p>Show model equation</p>
<p>Parameters:</p>
<ul>
<li><code>intercept_formatter</code>: Intercept format specifier</li>
<li><code>coef_formatter</code>: Intercept format specifier</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_diabetes</span><span class="p">,</span> <span class="n">y_diabetes</span><span class="p">),</span> <span class="n">X_diabetes</span><span class="p">,</span> <span class="n">y_diabetes</span>
<span class="p">)</span>

<span class="n">inspector</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">),</span> <span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span>
<span class="p">)</span>

<span class="n">inspector</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_iris</span><span class="p">,</span> <span class="n">y_iris</span><span class="p">),</span> <span class="n">X_iris</span><span class="p">,</span> <span class="n">y_iris</span>
<span class="p">)</span>

<span class="n">inspector</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="plot_coefs_vs_hparam" class="doc_header"><code>plot_coefs_vs_hparam</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L464" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>plot_coefs_vs_hparam</code>(<strong><code>hparam</code></strong>:<code>str</code>, <strong><code>vals</code></strong>:<code>Sequence</code>[<code>float</code>])</p>
</blockquote>
<p>Plot coefficient values against a hyperparameter</p>
<p>Parameters:</p>
<ul>
<li><code>hparam</code>: Name of hyperparameter; must be an attribute of
<code>self.model</code></li>
<li><code>vals</code>: Values of that hyperparameter to use</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span><span class="n">Lasso</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_diabetes</span><span class="p">,</span> <span class="n">y_diabetes</span><span class="p">),</span> <span class="n">X_diabetes</span><span class="p">,</span> <span class="n">y_diabetes</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_coefs_vs_hparam</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">),</span> <span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_coefs_vs_hparam</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_iris</span><span class="p">,</span> <span class="n">y_iris</span><span class="p">),</span> <span class="n">X_iris</span><span class="p">,</span> <span class="n">y_iris</span>
<span class="p">)</span>

<span class="n">axes</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_coefs_vs_hparam</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This method is defined for linear regression and binary logistic regression models but not for multiclass logistic regression models.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="plot_waterfall (regression or binary linear model)" class="doc_header"><code>plot_waterfall (regression or binary linear model)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L492" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>plot_waterfall (regression or binary linear model)</code>(<strong><code>item</code></strong>:<code>Union</code>[<code>Series</code>, <code>array</code>], <strong><code>bar_num_formatter</code></strong>:<code>str</code>=<em><code>'.1f'</code></em>, <strong><code>tick_num_formatter</code></strong>:<code>str</code>=<em><code>'.2f'</code></em>, <strong><code>sorted_value</code></strong>=<em><code>True</code></em>, <strong><code>threshold</code></strong>=<em><code>0.01</code></em>, <strong><code>blue_color</code></strong>=<em><code>'#377eb8'</code></em>, <strong><code>green_color</code></strong>=<em><code>'#4daf4a'</code></em>, <strong><code>red_color</code></strong>=<em><code>'#ff7f00'</code></em>, <strong><code>Title</code></strong>=<em><code>''</code></em>, <strong><code>x_lab</code></strong>=<em><code>''</code></em>, <strong><code>y_lab</code></strong>=<em><code>''</code></em>, <strong><code>formatting</code></strong>=<em><code>'{:,.1f}'</code></em>, <strong><code>other_label</code></strong>=<em><code>'other'</code></em>, <strong><code>net_label</code></strong>=<em><code>'net'</code></em>, <strong><code>rotation_value</code></strong>=<em><code>30</code></em>)</p>
</blockquote>
<p>Make a waterfall chart showing how each feature contributes
        to the prediction for the input item.</p>

<pre><code>    Parameters:
    - `item`: Input item, with the same shape and value meanings as
    a single row from `self.X`
    - `bar_num_formatter`: Bar label format specifier
    - `tick_num_formatter`: Tick label format specifier

    Additional keyword arguments will be passed to
    `waterfall_chart.plot`

</code></pre>
<p>Remaining parameters are passed to
<code>waterfall_chart.plot</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_diabetes</span><span class="p">,</span> <span class="n">y_diabetes</span><span class="p">),</span> <span class="n">X_diabetes</span><span class="p">,</span> <span class="n">y_diabetes</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_waterfall</span><span class="p">(</span><span class="n">X_diabetes</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">),</span> <span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_waterfall</span><span class="p">(</span><span class="n">X_cancer</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rotation_value</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">test_fig_exists</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Decision-Tree-Models">Decision Tree Models<a class="anchor-link" href="#Decision-Tree-Models"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All decision tree model inspectors have the following methods.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="show_model (tree model)" class="doc_header"><code>show_model (tree model)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L724" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>show_model (tree model)</code>(<strong><code>ax</code></strong>:<code>Optional</code>[<code>Axes</code>]=<em><code>None</code></em>, <strong><code>max_depth</code></strong>=<em><code>None</code></em>, <strong><code>feature_names</code></strong>=<em><code>None</code></em>, <strong><code>class_names</code></strong>=<em><code>None</code></em>, <strong><code>label</code></strong>=<em><code>'all'</code></em>, <strong><code>filled</code></strong>=<em><code>False</code></em>, <strong><code>impurity</code></strong>=<em><code>True</code></em>, <strong><code>node_ids</code></strong>=<em><code>False</code></em>, <strong><code>proportion</code></strong>=<em><code>False</code></em>, <strong><code>rotate</code></strong>=<em><code>'deprecated'</code></em>, <strong><code>rounded</code></strong>=<em><code>False</code></em>, <strong><code>precision</code></strong>=<em><code>3</code></em>, <strong><code>fontsize</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Show decision tree
Remaining parameters are passed to
<code>sklearn.tree._export.plot_tree</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_diabetes</span><span class="p">,</span> <span class="n">y_diabetes</span><span class="p">),</span>
    <span class="n">X_diabetes</span><span class="p">,</span>
    <span class="n">y_diabetes</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">),</span> <span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span>
<span class="p">)</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_iris</span><span class="p">,</span> <span class="n">y_iris</span><span class="p">),</span>
    <span class="n">X_iris</span><span class="p">,</span>
    <span class="n">y_iris</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">show_model</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SearchCV-Models-with-One-Or-Two-Hyperparameters">SearchCV Models with One Or Two Hyperparameters<a class="anchor-link" href="#SearchCV-Models-with-One-Or-Two-Hyperparameters"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Inspectors for models that inherit from <code>BaseSearchCV</code> have the following methods.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="plot_scores_vs_hparam" class="doc_header"><code>plot_scores_vs_hparam</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L774" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>plot_scores_vs_hparam</code>(<strong><code>hparam</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>None</code></em>, <strong><code>score_cols</code></strong>:<code>Union</code>[<code>str</code>, <code>List</code>[<code>str</code>], <code>NoneType</code>]=<em><code>None</code></em>, <strong><code>ax</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot model scores against values of one hyperparameter</p>
<p>Parameters:</p>
<ul>
<li><code>hparam</code>: Name of the hyperparameter to plot against. Must be
provided if there are multiple hyperparameters. Any other
hyperparameters will be fixed at the value they have in
<code>self.model.best_params_</code>.</li>
<li><code>score_cols</code>: Name of score columns to plot. By default will
be the mean test and (if present) train score for the primary
scoring metric.</li>
<li><code>ax</code>: Matplotlib <code>Axes</code> object. Plot will be added to this object
if provided; otherwise a new <code>Axes</code> object will be generated.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">param_grid</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;min_samples_leaf&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">)},</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">KFold</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">)</span><span class="o">.</span><span class="n">plot_scores_vs_hparam</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">param_grid</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;min_samples_leaf&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">)},</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">return_train_score</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">KFold</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">)</span><span class="o">.</span><span class="n">plot_scores_vs_hparam</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">param_grid</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;min_samples_leaf&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="s2">&quot;max_features&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">KFold</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_scores_vs_hparam</span><span class="p">(</span><span class="s2">&quot;min_samples_leaf&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_scores_vs_hparam</span><span class="p">(</span><span class="s2">&quot;max_features&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="show_score_vs_hparam_pair" class="doc_header"><code>show_score_vs_hparam_pair</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L857" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>show_score_vs_hparam_pair</code>(<strong><code>hparams</code></strong>=<em><code>None</code></em>, <strong><code>score_col</code></strong>=<em><code>None</code></em>, <strong><code>cmap</code></strong>=<em><code>'PuBu'</code></em>, <strong><code>low</code></strong>:<code>float</code>=<em><code>0</code></em>, <strong><code>high</code></strong>:<code>float</code>=<em><code>0</code></em>, <strong><code>axis</code></strong>:<code>Union</code>[<code>str</code>, <code>int</code>, <code>NoneType</code>]=<em><code>0</code></em>, <strong><code>subset</code></strong>=<em><code>None</code></em>, <strong><code>text_color_threshold</code></strong>:<code>float</code>=<em><code>0.408</code></em>, <strong><code>vmin</code></strong>:<code>Optional</code>[<code>float</code>]=<em><code>None</code></em>, <strong><code>vmax</code></strong>:<code>Optional</code>[<code>float</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Show model scores against a pair of hyperparameters</p>

<pre><code>    Parameters:
    - `hparams`: Name of the hyperparameters to plot against.
    The first two hyperparameters in `self.model.param_grid` will be
    used by default. Any other hyperparameters will be fixed at the
    value they have in `self.model.best_params_`.
    - `score_col`: Name of score column to plot. By default will
    be the mean test score for the primary scoring metric.

</code></pre>
<p>Remaining parameters are passed to
<code>pandas.io.formats.style.background_gradient</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span><span class="o">.</span><span class="n">show_score_vs_hparam_pair</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">=</span><span class="n">DecisionTreeRegressor</span><span class="p">(),</span>
    <span class="n">param_grid</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;min_samples_leaf&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="s2">&quot;max_features&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
        <span class="s2">&quot;splitter&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;best&quot;</span><span class="p">,</span> <span class="s2">&quot;random&quot;</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">KFold</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_scores_vs_hparam</span><span class="p">(</span><span class="s2">&quot;min_samples_leaf&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">X_cancer</span><span class="p">,</span> <span class="n">y_cancer</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_scores_vs_hparam</span><span class="p">(</span><span class="s2">&quot;max_features&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_scores_vs_hparam</span><span class="p">(</span><span class="s2">&quot;splitter&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span><span class="o">.</span><span class="n">show_score_vs_hparam_pair</span><span class="p">([</span><span class="s2">&quot;min_samples_leaf&quot;</span><span class="p">,</span> <span class="s2">&quot;max_features&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Models-with-One-Feature">Models with One Feature<a class="anchor-link" href="#Models-with-One-Feature"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An <code>Inspector</code> for any model with one feature has a <code>plot</code> method. The interface is slightly different for binary models than for multiclass or regression models.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="plot (single-feature binary model)" class="doc_header"><code>plot (single-feature binary model)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L956" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>plot (single-feature binary model)</code>(<strong><code>thresh</code></strong>:<code>float</code>=<em><code>0.5</code></em>, <strong><code>plot_data</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>ax</code></strong>:<code>Optional</code>[<code>Axes</code>]=<em><code>None</code></em>, <strong><code>prob_line_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>thresh_line_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>scatter_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>scatter_kwargs_correct</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>scatter_kwargs_incorrect</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot predictions from a binary classification model that
provides probabilities and has a single input</p>
<p>Parameters:</p>
<ul>
<li><code>thresh</code>: Probability threshold for counting a prediction as
positive</li>
<li><code>plot_data</code>: Make a scatter plot of the data</li>
<li><code>ax</code>: Matplotlib <code>Axes</code> object. Plot will be added to this
object if provided; otherwise a new <code>Axes</code> object will be
generated.</li>
<li><code>prob_line_kwargs</code>: kwargs to pass to <code>ax.plot</code> for plotting
model probabilities</li>
<li><code>thresh_line_kwargs</code>: kwargs to pass to <code>ax.plot</code> for plotting
threshold</li>
<li><code>scatter_kwargs</code>: kwargs to pass to <code>ax.scatter</code> for plotting
all data points</li>
<li><code>scatter_kwargs_correct</code>: kwargs to pass to <code>ax.scatter</code> for
plotting data points that the model predicted correctly.
Overrides <code>scatter_kwargs</code>.</li>
<li><code>scatter_kwargs_incorrect</code>: kwargs to pass to <code>ax.scatter</code> for
plotting data points that the model predicted incorrectly.
Overrides <code>scatter_kwargs</code>.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">y_cancer</span><span class="p">),</span>
    <span class="n">X_cancer</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
    <span class="n">y_cancer</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">scatter_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="plot (single-feature regression or multiclass model)" class="doc_header"><code>plot (single-feature regression or multiclass model)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L908" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>plot (single-feature regression or multiclass model)</code>(<strong><code>plot_data</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>ax</code></strong>:<code>Optional</code>[<code>Axes</code>]=<em><code>None</code></em>, <strong><code>line_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>scatter_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot predictions from a regression model with a single input</p>
<p>Parameters:</p>
<ul>
<li><code>plot_data</code>: Make a scatter plot of the data</li>
<li><code>line_kwargs</code>: kwargs to pass to <code>ax.plot</code> for plotting
predictions</li>
<li><code>scatter_kwargs</code>: kwargs to pass to <code>ax.scatter</code> for plotting data</li>
<li><code>ax</code>: Matplotlib <code>Axes</code> object. Plot will be added to this object
if provided; otherwise a new <code>Axes</code> object will be generated.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_iris</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_iris</span><span class="p">),</span>
    <span class="n">X_iris</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">y_iris</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rfr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_diabetes</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">]],</span> <span class="n">y_diabetes</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">rfr</span><span class="p">,</span>
    <span class="n">X_diabetes</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">]],</span>
    <span class="n">y_diabetes</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is the same random forest along with some of its constituent decision trees:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">rfr</span><span class="p">,</span>
    <span class="n">X_diabetes</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">]],</span>
    <span class="n">y_diabetes</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">estimator</span> <span class="ow">in</span> <span class="n">rfr</span><span class="o">.</span><span class="n">estimators_</span><span class="p">[:</span><span class="mi">20</span><span class="p">]:</span>
    <span class="n">get_inspector</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X_diabetes</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">]],</span> <span class="n">y_diabetes</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_data</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">line_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Models-with-Two-Features">Models with Two Features<a class="anchor-link" href="#Models-with-Two-Features"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An <code>Inspector</code> for any model with two features also has a <code>plot</code> method.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="plot (two-feature model)" class="doc_header"><code>plot (two-feature model)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L1169" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>plot (two-feature model)</code>(<strong><code>plot_data</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>tick_formatter</code></strong>:<code>Optional</code>[<code>str</code>]=<em><code>'.2f'</code></em>, <strong><code>ax</code></strong>:<code>Axes</code>=<em><code>None</code></em>, <strong><code>heatmap_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>scatter_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot predictions from a model with two inputs as a heatmap.</p>
<p>Parameters:</p>
<ul>
<li><code>plot_data</code>: Make a scatter plot of the data</li>
<li><code>tick_formatter</code>: Tick label format specifier</li>
<li><code>ax</code>: Matplotlib <code>Axes</code> object. Plot will be added to this object
if provided; otherwise a new <code>Axes</code> object will be generated.</li>
<li><code>heatmap_kwargs</code>: kwargs to pass to <code>sns.heatmap</code> for plotting
predictions</li>
<li><code>scatter_kwargs</code>: kwargs to pass to <code>ax.scatter</code> for plotting data</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_cancer</span><span class="p">),</span>
    <span class="n">X_cancer</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">y_cancer</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_iris</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_iris</span><span class="p">),</span>
    <span class="n">X_iris</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">y_iris</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rfr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_diabetes</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">,</span> <span class="s2">&quot;bp&quot;</span><span class="p">]],</span> <span class="n">y_diabetes</span>
<span class="p">)</span>
<span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">rfr</span><span class="p">,</span>
    <span class="n">X_diabetes</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">,</span> <span class="s2">&quot;bp&quot;</span><span class="p">]],</span>
    <span class="n">y_diabetes</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can fit a model on a training set and then generate an inspector for the test set to inspect overfitting.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_diabetes_train</span><span class="p">,</span> <span class="n">X_diabetes_test</span><span class="p">,</span> <span class="n">y_diabetes_train</span><span class="p">,</span> <span class="n">y_diabetes_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_diabetes</span><span class="p">,</span> <span class="n">y_diabetes</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="n">dtr</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_diabetes_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">,</span> <span class="s2">&quot;bp&quot;</span><span class="p">]],</span> <span class="n">y_diabetes_train</span>
<span class="p">)</span>
<span class="n">inspector_train</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">dtr</span><span class="p">,</span>
    <span class="n">X_diabetes_train</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">,</span> <span class="s2">&quot;bp&quot;</span><span class="p">]],</span>
    <span class="n">y_diabetes_train</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector_train</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector_test</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">dtr</span><span class="p">,</span>
    <span class="n">X_diabetes_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">,</span> <span class="s2">&quot;bp&quot;</span><span class="p">]],</span>
    <span class="n">y_diabetes_test</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector_test</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An <code>Inspector</code> for a model with two features also has a <code>plot3d</code> method. The interface is slightly different for binary models than for multiclass or regression models.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="plot3d (binary model)" class="doc_header"><code>plot3d (binary model)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L1426" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>plot3d (binary model)</code>(<strong><code>thresh</code></strong>=<em><code>0.5</code></em>, <strong><code>plot_prob</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>plot_thresh</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>plot_data</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>ax</code></strong>:<code>Axes</code>=<em><code>None</code></em>, <strong><code>prob_surf_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>thresh_surf_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>scatter_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot data and predictions in 3D</p>
<p>Best viewed with a tool such as <a href="https://github.com/matplotlib/ipympl">https://github.com/matplotlib/ipympl</a>
that supports rotating the output</p>
<p>Parameters:</p>
<ul>
<li><code>thresh</code>: Probability threshold for counting a prediction as
positive</li>
<li><code>plot_prob</code>: Whether to plot the model probabilities</li>
<li><code>plot_thresh</code>: Whether to plot a classification threshold</li>
<li><code>plot_data</code>: Whether to plot the data</li>
<li><code>ax</code>: Matplotlib <code>Axes</code> object. Plot will be added to this object
if provided; otherwise a new <code>Axes</code> object will be generated.</li>
<li><code>prob_surf_kwargs</code>: kwargs to pass to the model probability
surface</li>
<li><code>thresh_surf_kwargs</code>: kwargs to pass to the threshold surface</li>
<li><code>scatter_kwargs</code>: kwargs to pass to the scatter plot of the data</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_cancer</span><span class="p">),</span>
    <span class="n">X_cancer</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">y_cancer</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot3d</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An interactive tool such as <a href="https://github.com/matplotlib/ipympl">ipyml</a> makes it easier to see depth in these 3D plots:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Video</span>

<span class="n">Video</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/gsganden/model_inspector/blob/master/docs/regression_3d.mov?raw=true&quot;</span>  <span class="c1"># noqa: E501</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="plot3d (two-feature regression or multiclass model)" class="doc_header"><code>plot3d (two-feature regression or multiclass model)</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L1231" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>plot3d (two-feature regression or multiclass model)</code>(<strong><code>plot_data</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>ax</code></strong>:<code>Axes</code>=<em><code>None</code></em>, <strong><code>surf_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>, <strong><code>scatter_kwargs</code></strong>:<code>Optional</code>[<code>dict</code>]=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot data and predictions in 3d</p>
<p>Best viewed with a tool such as <a href="https://github.com/matplotlib/ipympl">https://github.com/matplotlib/ipympl</a>
that supports rotating the output</p>
<p>Parameters:</p>
<ul>
<li><code>plot_data</code>: Make a scatter plot of the data</li>
<li><code>ax</code>: Matplotlib <code>Axes</code> object. Plot will be added to this object
if provided; otherwise a new <code>Axes</code> object will be generated.</li>
<li><code>surf_kwargs</code>: kwargs to pass to <code>ax.plot_surface</code> for plotting
predictions</li>
<li><code>scatter_kwargs</code>: kwargs to pass to <code>ax.scatter</code> for plotting data</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10_000</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_iris</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_iris</span><span class="p">),</span>
    <span class="n">X_iris</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span>
    <span class="n">y_iris</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot3d</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">225</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">X_diabetes</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">,</span> <span class="s2">&quot;bp&quot;</span><span class="p">]],</span> <span class="n">y_diabetes</span>
    <span class="p">),</span>
    <span class="n">X_diabetes</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">,</span> <span class="s2">&quot;bp&quot;</span><span class="p">]],</span>
    <span class="n">y_diabetes</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot3d</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Ensemble-Models-With-Two-Features">Ensemble Models With Two Features<a class="anchor-link" href="#Ensemble-Models-With-Two-Features"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Ensemble models with an <code>.estimators_</code> attribute that have two features also have a <code>.plot_components()</code> method. (There is no analogous method for models with one feature because plotting the component estimators along with the ensemble yourself is relatively easy in that case and makes it easier to customize the result.)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_components" class="doc_header"><code>plot_components</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L1294" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_components</code>(<strong><code>axes</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Plot components estimators</p>
<p>Parameters:</p>
<ul>
<li><code>axes</code>: NumPy array of Matplotlib <code>Axes</code> objects</li>
<li><code>kwargs</code>: kwargs to pass to <code>self.plot</code></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">axes</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_components</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">min_samples_leaf</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_cancer</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_cancer</span><span class="p">)</span>
<span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span><span class="n">rfc</span><span class="p">,</span> <span class="n">X_cancer</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_cancer</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_components</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rfc</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_iris</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_iris</span><span class="p">)</span>
<span class="n">inspector</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span><span class="n">rfc</span><span class="p">,</span> <span class="n">X_iris</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">y_iris</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">inspector</span><span class="o">.</span><span class="n">plot_components</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There is also a <code>.plot_components3d()</code> method to plot estimators within an ensemble models that has two features.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_components3d" class="doc_header"><code>plot_components3d</code><a href="https://github.com/gsganden/model_inspector/tree/main/model_inspector/inspect.py#L1319" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_components3d</code>(<strong><code>axes</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Plot components estimators in 3D</p>
<p>Parameters:</p>
<ul>
<li><code>axes</code>: NumPy array of Matplotlib <code>Axes</code> objects</li>
<li><code>kwargs</code>: kwargs to pass to <code>self.plot3d</code></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">axes</span> <span class="o">=</span> <span class="n">get_inspector</span><span class="p">(</span>
    <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
        <span class="n">X_diabetes</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">,</span> <span class="s2">&quot;bp&quot;</span><span class="p">]],</span> <span class="n">y_diabetes</span>
    <span class="p">),</span>
    <span class="n">X_diabetes</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;bmi&quot;</span><span class="p">,</span> <span class="s2">&quot;bp&quot;</span><span class="p">]],</span>
    <span class="n">y_diabetes</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">plot_components3d</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">():</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">255</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

